<!doctype html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rent vs Buy Calculator</title>

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7128041898898911" crossorigin="anonymous"></script>

  <style>
    :root{
      --bg1:#667eea; --bg2:#764ba2; --card:#ffffff;
      --muted:#6b7280; --txt:#0f172a; --accent:#6d28d9; --accent2:#4f46e5;
      --radius:18px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--txt); -webkit-font-smoothing: antialiased; padding: 24px;
    }
    .container{max-width:1200px;margin:0 auto}
    header{color:#fff;margin-bottom:22px}
    header h1{font-size:clamp(24px,3vw,36px);font-weight:800;letter-spacing:.2px}
    header p{opacity:.9;margin-top:6px}
    .app{display:grid;gap:18px;grid-template-columns:1fr}
    @media (min-width:980px){.app{grid-template-columns:1.2fr .8fr}}
    .card{
      background:var(--card);border-radius:var(--radius);box-shadow:0 10px 30px rgba(0,0,0,.12);padding:18px
    }
    .card h2{font-size:18px;margin-bottom:12px}
    .grid{display:grid;gap:10px;grid-template-columns:1fr}
    @media (min-width:640px){.grid{grid-template-columns:1fr 1fr}}
    .field{
      display:flex;flex-direction:column;gap:6px;background:#f8fafc;border:1px solid #e5e7eb;
      padding:10px;border-radius:12px
    }
    .field label{font-size:12px;color:#475569;letter-spacing:.2px}
    .field input{
      font:inherit;padding:10px 12px;border-radius:8px;border:1px solid #e2e8f0;background:#fff;outline:none
    }
    .field input:focus{border-color:var(--accent2);box-shadow:0 0 0 3px rgba(79,70,229,.15)}
    .row-3{grid-column:span 2}
    .btn{
      appearance:none;border:0;border-radius:12px;padding:12px 14px;font-weight:700;cursor:pointer;
      background:linear-gradient(135deg,var(--accent2),var(--accent));color:#fff;width:100%;
      transition:transform .05s ease, filter .2s ease
    }
    .btn:active{transform:translateY(1px)}
    .muted{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:8px;font-size:12px;padding:8px 10px;border-radius:999px;background:#f1f5f9;border:1px solid #e2e8f0}
    .result{display:grid;gap:12px}
    .stat{
      background:#f8fafc;border:1px solid #e5e7eb;border-radius:14px;padding:14px;display:flex;align-items:center;justify-content:space-between;gap:12px
    }
    .stat .label{font-size:12px;color:#475569}
    .stat .value{font-weight:800;font-size:18px}
    canvas{width:100%;height:260px;background:#fff;border:1px solid #eaeaea;border-radius:14px}
    footer{color:#eef;text-align:center;margin-top:18px;font-size:12px}
    .ads{background:#ffffff;border-radius:12px;border:1px dashed #e5e7eb;padding:8px}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Rent vs Buy Calculator</h1>
      <p class="muted">Kira mı ev almak mı? Basit varsayımlarla toplam maliyeti karşılaştır.</p>
    </header>

    <div class="app">
      <!-- Sol: Girdiler -->
      <section class="card">
        <h2>Girdiler</h2>
        <form id="form" class="grid" onsubmit="event.preventDefault();calculate();">
          <div class="field">
            <label>Aylık Kira (₺)</label>
            <input type="number" id="rent" inputmode="decimal" value="35000" min="0" step="100">
          </div>
          <div class="field">
            <label>Kira Artış Oranı (yıllık, %)</label>
            <input type="number" id="rentInfl" inputmode="decimal" value="20" min="0" step="0.1">
          </div>
          <div class="field">
            <label>Ev Fiyatı (₺)</label>
            <input type="number" id="price" inputmode="decimal" value="4000000" min="0" step="1000">
          </div>
          <div class="field">
            <label>Peşinat (%)</label>
            <input type="number" id="downPct" inputmode="decimal" value="20" min="0" step="0.1">
          </div>
          <div class="field">
            <label>Mortgage Faizi (yıllık, %)</label>
            <input type="number" id="rate" inputmode="decimal" value="2" min="0" step="0.01">
          </div>
          <div class="field">
            <label>Kredi Süresi (yıl)</label>
            <input type="number" id="yearsLoan" inputmode="numeric" value="10" min="1" step="1">
          </div>
          <div class="field">
            <label>Horizon (karşılaştırma süresi, yıl)</label>
            <input type="number" id="years" inputmode="numeric" value="10" min="1" step="1">
          </div>
          <div class="field">
            <label>Vergi + Sigorta (yıllık, % / ev bedeli)</label>
            <input type="number" id="tiPct" inputmode="decimal" value="0.5" min="0" step="0.05">
          </div>
          <div class="field">
            <label>Bakım (yıllık, % / ev bedeli)</label>
            <input type="number" id="maintPct" inputmode="decimal" value="1" min="0" step="0.1">
          </div>
          <div class="field">
            <label>HOA / Site Aidatı (aylık, ₺)</label>
            <input type="number" id="hoa" inputmode="decimal" value="0" min="0" step="50">
          </div>
          <div class="field">
            <label>Ev Değer Artışı (yıllık, %)</label>
            <input type="number" id="homeApp" inputmode="decimal" value="8" min="0" step="0.1">
          </div>
          <div class="field">
            <label>Peşinat Alternatif Getirisi (yıllık, %)</label>
            <input type="number" id="altRet" inputmode="decimal" value="6" min="0" step="0.1">
          </div>
          <div class="field">
            <label>Kapanış Maliyeti (alış, %)</label>
            <input type="number" id="closeBuy" inputmode="decimal" value="2" min="0" step="0.1">
          </div>
          <div class="field">
            <label>Satış Masrafı (satış, %)</label>
            <input type="number" id="sellCost" inputmode="decimal" value="4" min="0" step="0.1">
          </div>
          <div class="row-3">
            <button class="btn" type="submit">Hesapla</button>
          </div>
          <div class="row-3">
            <span class="pill">İpucu: Hesap <strong>vergiler + bakım + fırsat maliyeti</strong> gibi kalemleri içerir.</span>
          </div>
        </form>
      </section>

      <!-- Sağ: Sonuçlar + Reklam -->
      <section class="card">
        <h2>Sonuçlar</h2>
        <div class="result" id="results">
          <div class="stat">
            <div>
              <div class="label">Kira Toplam Maliyeti (₺)</div>
              <div class="value" id="rentTotal">—</div>
            </div>
          </div>

          <div class="stat">
            <div>
              <div class="label">Satın Alma Net Maliyeti (₺)</div>
              <div class="value" id="buyNet">—</div>
            </div>
          </div>

          <div class="stat" id="winner">
            <div>
              <div class="label">Avantaj</div>
              <div class="value" id="adv">—</div>
            </div>
          </div>

          <canvas id="chart" height="260" aria-label="Karşılaştırma grafiği"></canvas>

          <!-- AdSense Alanı -->
          <div class="ads">
            <!-- rentorbuy_test -->
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7128041898898911"
                 data-ad-slot="7200865026"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
          </div>
        </div>
      </section>
    </div>

    <footer>
      <p>⚠️ Bu araç basitleştirilmiş varsayımlar içerir; finansal tavsiye değildir.</p>
    </footer>
  </div>

  <!-- Reklamı yüklet -->
  <script>
    // Sadece bir kez push et
    (function(){
      try {
        if (!window.__ad_pushed__) {
          (adsbygoogle = window.adsbygoogle || []).push({});
          window.__ad_pushed__ = true;
        }
      } catch(e) {}
    })();
  </script>

  <script>
    // ==== Yardımcı Fonksiyonlar ====
    const fmt = (n) => new Intl.NumberFormat('tr-TR', {maximumFractionDigits:0}).format(Math.round(n||0));

    function monthlyPayment(principal, annualRatePct, years){
      const r = (annualRatePct/100)/12;
      const n = years*12;
      if (r === 0) return principal / n;
      return principal * (r * Math.pow(1+r, n)) / (Math.pow(1+r, n) - 1);
    }
    const grow = (val, ratePct, years) => val * Math.pow(1 + ratePct/100, years);

    function totalRent(initialMonthly, inflPct, years){
      let total = 0, m = initialMonthly;
      for (let y=0; y<years; y++){ total += m*12; m *= (1 + inflPct/100); }
      return total;
    }

    function remainingBalance(principal, annualRatePct, yearsTotal, yearAt){
      const r = (annualRatePct/100)/12;
      const n = yearsTotal*12, p = yearAt*12;
      if (r === 0){
        const paid = (principal / n) * p;
        return Math.max(0, principal - paid);
      }
      const payment = monthlyPayment(principal, annualRatePct, yearsTotal);
      const bal = principal * Math.pow(1+r, p) - payment * ((Math.pow(1+r, p)-1)/r);
      return Math.max(0, bal);
    }

    function buyNetCost(params){
      const {
        price, downPct, rate, yearsLoan, yearsHorizon,
        tiPct, maintPct, hoaMonthly,
        altReturnPct, closeBuyPct, sellCostPct, homeAppPct
      } = params;

      const down = price * (downPct/100);
      const loan = Math.max(0, price - down);
      const monthlyPay = monthlyPayment(loan, rate, yearsLoan);
      const months = Math.min(yearsHorizon, yearsLoan) * 12;
      const paidInstallments = monthlyPay * months;

      let tiTotal = 0, maintTotal = 0, hoaTotal = 0;
      for (let y=0; y<yearsHorizon; y++){
        const base = grow(price, homeAppPct, y);
        tiTotal   += base * (tiPct/100);
        maintTotal+= base * (maintPct/100);
        hoaTotal  += hoaMonthly * 12;
      }

      const closeBuy = price * (closeBuyPct/100);
      const opportunityEnd = (down + closeBuy) * (Math.pow(1 + altReturnPct/100, yearsHorizon) - 1);

      const homeValueEnd = grow(price, homeAppPct, yearsHorizon);
      const remBal = remainingBalance(loan, rate, yearsLoan, Math.min(yearsHorizon, yearsLoan));
      const equity = Math.max(0, homeValueEnd - remBal);

      const sellCost = homeValueEnd * (sellCostPct/100);

      const grossCosts = down + closeBuy + paidInstallments + tiTotal + maintTotal + hoaTotal + opportunityEnd + sellCost;
      const net = grossCosts - equity;

      return { net, breakdown:{ down, closeBuy, paidInstallments, tiTotal, maintTotal, hoaTotal, opportunityEnd, sellCost, equity, monthlyPay } };
    }

    function calculate(){
      const rent          = +document.getElementById('rent').value || 0;
      const rentInfl      = +document.getElementById('rentInfl').value || 0;
      const price         = +document.getElementById('price').value || 0;
      const downPct       = +document.getElementById('downPct').value || 0;
      const rate          = +document.getElementById('rate').value || 0;
      const yearsLoan     = +document.getElementById('yearsLoan').value || 0;
      const years         = +document.getElementById('years').value || 0;
      const tiPct         = +document.getElementById('tiPct').value || 0;
      const maintPct      = +document.getElementById('maintPct').value || 0;
      const hoa           = +document.getElementById('hoa').value || 0;
      const homeApp       = +document.getElementById('homeApp').value || 0;
      const altRet        = +document.getElementById('altRet').value || 0;
      const closeBuyPct   = +document.getElementById('closeBuy').value || 0;
      const sellCostPct   = +document.getElementById('sellCost').value || 0;

      const rentTotal = totalRent(rent, rentInfl, years);

      const {net: buyNet} = buyNetCost({
        price, downPct, rate, yearsLoan, yearsHorizon: years,
        tiPct, maintPct, hoaMonthly: hoa,
        altReturnPct: altRet, closeBuyPct, sellCostPct, homeAppPct: homeApp
      });

      document.getElementById('rentTotal').textContent = "₺ " + fmt(rentTotal);
      document.getElementById('buyNet').textContent    = "₺ " + fmt(buyNet);

      const winner = document.getElementById('winner');
      const advEl  = document.getElementById('adv');
      winner.classList.remove('ok','warn','err');

      if (rentTotal < buyNet){
        advEl.textContent = "Kira daha avantajlı (fark: ₺ " + fmt(buyNet - rentTotal) + ")";
      } else if (buyNet < rentTotal){
        advEl.textContent = "Satın alma daha avantajlı (fark: ₺ " + fmt(rentTotal - buyNet) + ")";
      } else {
        advEl.textContent = "Başabaş";
      }

      drawChart(rentTotal, buyNet);
    }

    function drawChart(rentTotal, buyNet){
      const c = document.getElementById('chart');
      const ctx = c.getContext('2d');
      const dpr = window.devicePixelRatio || 1;
      const W = c.clientWidth, H = c.clientHeight;
      if (c.width  !== W * dpr) c.width  = W * dpr;
      if (c.height !== H * dpr) c.height = H * dpr;
      ctx.setTransform(1,0,0,1,0,0);
      ctx.scale(dpr, dpr);

      ctx.clearRect(0,0,W,H);

      const pad = 24;
      const plotW = W - pad*2;
      const plotH = H - pad*2;

      ctx.strokeStyle = "#e5e7eb"; ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(pad, H - pad); ctx.lineTo(W - pad, H - pad); ctx.stroke();

      const data = [
        {label:"Kira", value: rentTotal},
        {label:"Satın Alım", value: buyNet}
      ];
      const max = Math.max(...data.map(d=>d.value)) || 1;
      const barW = Math.min(120, plotW / (data.length*2));
      const gap  = barW;

      data.forEach((d,i)=>{
        const x = pad + i*(barW+gap) + gap*0.5;
        const h = (d.value / max) * (plotH - 10);
        const y = H - pad - h;

        ctx.fillStyle = "rgba(79,70,229,.10)"; ctx.fillRect(x-2, y+6, barW+4, h);

        const grad = ctx.createLinearGradient(0,y,0,y+h);
        grad.addColorStop(0,"#4f46e5"); grad.addColorStop(1,"#6d28d9");
        ctx.fillStyle = grad; roundRect(ctx, x, y, barW, h, 10); ctx.fill();

        ctx.fillStyle = "#111827"; ctx.font = "700 14px system-ui, -apple-system, Segoe UI, Roboto";
        ctx.textAlign = "center"; ctx.fillText("₺ " + fmt(d.value), x + barW/2, y - 8);

        ctx.fillStyle = "#475569"; ctx.font = "600 12px system-ui, -apple-system, Segoe UI, Roboto";
        ctx.fillText(d.label, x + barW/2, H - pad + 16);
      });
    }

    function roundRect(ctx, x, y, w, h, r){
      const rr = Math.min(r, w/2, h/2);
      ctx.beginPath();
      ctx.moveTo(x+rr, y);
      ctx.arcTo(x+w, y, x+w, y+h, rr);
      ctx.arcTo(x+w, y+h, x, y+h, rr);
      ctx.arcTo(x, y+h, x, y, rr);
      ctx.arcTo(x, y, x+w, y, rr);
      ctx.closePath();
    }

    window.addEventListener('load', calculate);
  </script>
</body>
</html>

